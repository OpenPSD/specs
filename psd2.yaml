openapi: 3.0.0
info:
  version: 0.0.1
  title: OpenPSD PSD2 
  description: |
    PSD2 API based on the Berlin Group specs
  contact:
    name: OpenPSD
    email: webmaster@openpsd.org
    url: http://openpsd.org
  termsOfService: http://openpsd.org/terms/
  license:
    name: GNU General Public License
    url: https://www.gnu.org/licenses/gpl-3.0.html
servers:
  - url: '{protocol}://api.openpsd.org/psd2/v1'
    variables:
      protocol:
        enum:
          - http
          - https
        default: https
    description: Sandbox  
components:
  # Reusable schemas (data models)
  schemas:
    consentId:
      type: string
      description: 'Identification of the consent resource as it is used in the API structure. Shall be contained, if a consent resource was generated.'
    frequency:
      type: string
      enum:
        - Daily
        - Weekly
        - EveryTwoWeeks
        - Monthly
        - EveryTwoMonths
        - Quarterly
        - SemiAnnual
        - Annual
    transactionFeeIndicator:
      type: boolean
    scaStatus:
      type: string
    psuMessage:
      type: string
    paymentId:
      type: string
    HrefType:
      type: string
    Authorization:
      type: string
    ConsentStatus:
      type: string
    Currency:
      type: string
      description: ISO 4217 Alpha 3 currency code
      maxLength: 3
    ExchangeRate:
      type: object
      required:
        - currencyFrom
        - rateFrom
        - currencyTo
        - rateTo
        - rateDate
      properties:
        currencyFrom:
          $ref: '#/components/schemas/Currency'
        rateFrom:
          type: string
        currencyTo:
          $ref: '#/components/schemas/Currency'
        rateTo:
          type: string
        rateDate:
          type: string
          format: date
        rateContract:
          type: string
    PSUData:
      type: object
      properties:
        password:
          type: string
    Address:
      type: object
      required:
        - country
      properties:
        street:
          type: string
        buildingNumber:
          type: string
        city:
          type: string
        postalCode:
          type: string
        country:
          type: string
    Remittance:
      type: object
      required:
        - reference
      properties:
        reference:
          type: string
          maxLength: 35
        referenceType:
          type: string
          maxLength: 35
        referenceIssuer:
          type: string
          maxLength: 35
    Amount:
      type: object
      required:
        - currency
        - amount
      properties:
        currency:
          $ref: '#/components/schemas/Currency'
        amount:
          type: string
          description: The amount given with fractional digits, where fractions must be compliant to the currency definition. Up to 14 significant figures. Negative amounts are signed by minus. The decimal separator is a dot.
    AccountReference:
      type: object
      properties:
        iban:
          type: string
          format: iban
          description: This data element can be used in the body of the Consent Request Message for retrieving account access consent from this payment account.
        bban:
          type: string
          format: bban
          description: This data element can be used in the body of the Consent Request Message for retrieving account access consent from this account. This data elements is used for payment accounts which have no IBAN.
        pan:
          type: string
          maxLength: 35
          description: 'Primary Account Number (PAN) of a card, can be tokenized by the ASPSP due to PCI DSS requirements. This data element can be used in the body of the Consent Request Message for retrieving account access consent from this card.'
        maskedPan:
          type: string
          maxLength: 35
          description: 'Primary Account Number (PAN) of a card, can be tokenized by the ASPSP due to PCI DSS requirements. This data element can be used in the body of the Consent Request Message for retrieving account access consent from this card.'
        msisdn:
          type: string
          maxLength: 35
          description: An alias to access a payment account via a registered mobile phone number. This alias might be needed e.g. in the payment initiation service. The support of this alias must be explicitly documented by the ASPSP for the corresponding API Calls.
        currency:
          $ref: '#/components/schemas/Currency'
    AccountAccess:
      type: object
      properties:
        accounts:
          type: array
          items:
            $ref: '#/components/schemas/AccountReference'
          description: Is asking for detailed account information. If the array is empty, the TPP is asking for an accessible account list. This may be restricted in a PSU/ASPSP authorization dialogue.
        balances:
          type: array
          items:
            $ref: '#/components/schemas/AccountReference'
          description: Is asking for balances of the addressed accounts. If the array is empty, the TPP is asking for the balances of all accessible account lists. This may be restricted in a PSU/ASPSP authorization dialogue
        transactions:
          type: array
          items:
            $ref: '#/components/schemas/AccountReference'
          description: Is asking for transactions of the addressed accounts. If the array is empty, the TPP is asking for the transactions of all accessible account lists. This may be restricted in a PSU/ASPSP authorization dialogue
        availableAccounts:
          type: string
          enum:
            - allAccounts
            - allAccountsWithBalances
          description: 'Optional if supported by API provide. Only the values "allAccounts" or "allAccountsWithBalances" is admitted.'
        allPsd2:
          type: string
          enum:
            - allAccounts
          description: 'Optional if supported by API provide. Only the value "allAccounts" is admitted.'
    AccountDetails:
      type: object
      required:
        - currency
      properties:
        resourceid:
          type: string
          maxLength: 35
          description: This is the data element to be used in the path when retrieving data from a dedicated account.
        iban:
          type: string
          format: iban
          description: This data element can be used in the body of the Consent Request Message for retrieving account access consent from this payment account.
        bban:
          type: string
          format: bban
          description: This data element can be used in the body of the Consent Request Message for retrieving account access consent from this account. This data elements is used for payment accounts which have no IBAN.
        pan:
          type: string
          maxLength: 35
          description: 'Primary Account Number (PAN) of a card, can be tokenized by the ASPSP due to PCI DSS requirements. This data element can be used in the body of the Consent Request Message for retrieving account access consent from this card.'
        maskedPan:
          type: string
          maxLength: 35
          description: 'Primary Account Number (PAN) of a card, can be tokenized by the ASPSP due to PCI DSS requirements. This data element can be used in the body of the Consent Request Message for retrieving account access consent from this card.'
        msisdn:
          type: string
          maxLength: 35
          description: An alias to access a payment account via a registered mobile phone number. This alias might be needed e.g. in the payment initiation service. The support of this alias must be explicitly documented by the ASPSP for the corresponding API Calls.
        currency:
          $ref: '#/components/schemas/Currency'
        name:
          type: string
          maxLength: 35
          description: Name given by the bank or the PSU in OnlineBanking.
        product:
          type: string
          maxLength: 35
          description: Product Name of the Bank for this account, proprietary definition
        cashAccountType:
          type: string
          description: ExternalCashAccountType1Code from ISO 20022
        bic:
          type: string
          description: The BIC associated to the account.
          format: bicfi
        linkedAccounts:
          type: string
          maxLength: 70
          description: Case of a set of pending card transactions, the APSP will provide the relevant cash account the card is set up on.
        usage:
          type: string
          maxLength: 140
          description: 'Specifies the usage of the account - PRIV: private personal account - ORGA: professional account'
        details:
          type: string
          maxLength: 140
          description: 'Specifications that might be provided by the ASPSP - characteristics of the account - characteristics of the relevant card'
        balances:
          type: array
          items:
            $ref: '#/components/schemas/Balance'
        _links:
          $ref: '#/components/schemas/Links'
          description: 'Links to the account, which can be directly used for retrieving account information from this dedicated account. Links to “balances” and/or “transactions”'
    AccountReport:
      type: object
      required:
        - booked
        - _links
      properties:
        booked:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
        pending:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
        _links:
          $ref: '#/components/schemas/Links'
          description: 'The following links might be used within this context, account link (mandatory), first_page_link (optional), second_page_link (optional), current_page_ link (optional), last_page_link (optional)'
    Balance:
      type: object
      properties:
        balanceAmount:
          $ref: '#/components/schemas/Amount'
        balanceType:
          type: string
          enum:
            - closingBooked
            - expected
            - authorised
            - openingBooked
            - interimAvailable
            - forwardAvailable
        lastChangeDateTime:
          type: string
          format: date-time
        referenceDate:
          type: string
          format: date
        lastCommittedTransaction:
          type: string
          maxLength: 35
    TransactionStatus:
      type: string
    Transaction:
      type: object
      required:
        - transactionAmount
      properties:
        transactionId:
          type: string
          description: 'Can be used as access-id in the API, where more details on an transaction is offered.'
        entryReference:
          type: string
          description: 'Is the identification of the transaction as used e.g. for reference for deltafunction on application level. The same identification as for example used within camt.05x messages'
          maxLength: 35
        endToEndId:
          type: string
          description: Unique end to end identity.
          maxLength: 35
        mandateId:
          type: string
          description: Identification of a Cheque.
          maxLength: 35
        creditorId:
          type: string
          description: Identification of Creditors, e.g. a SEPA Creditor ID
          maxLength: 35
        bookingDate:
          type: string
          format: date
          description: The Date when an entry is posted to an account on the ASPSPs books.
        valueDate:
          type: string
          format: date
          description: The Date at which assets become available to the account owner in case of a credit
        transactionAmount:
          $ref: '#/components/schemas/Amount'
        exchangeRates:
          type: array
          items:
            $ref: '#/components/schemas/ExchangeRate'
        creditorName:
          type: string
          description: Identification of Creditors, e.g. a SEPA Creditor ID
          maxLength: 70
        creditorAccount:
          $ref: '#/components/schemas/AccountReference'
        ultimateCreditor:
          type: string
          maxLength: 70
        debtorName:
          type: string
          description: Name of the debtor if a "Credited" transaction
          maxLength: 70
        debtorAccount:
          $ref: '#/components/schemas/AccountReference'
        ultimateDebtor:
          type: string
          maxLength: 70
        remittanceInformationStructured:
          type: string
          maxLength: 140
          description: Reference to be transported in the field.
        puposeCode:
          type: string
        bankTransactionCode:
          type: string
          description: Bank transaction code as used by the ASPSP and using the sub elements of this structured code defined by ISO20022
        proprietaryBankTransactionCode:
          type: string
          maxLength: 35
          description: proprietary bank transaction code as used within a community or within an ASPSP e.g. for MT94x based transaction reports
        _links:
          $ref: '#/components/schemas/Links'
          description: 'The following links could be used here: transactionDetails for retrieving details of a transaction.'
    Links:
      type: object
      properties:
        scaRedirect:
          $ref: '#/components/schemas/HrefType'
          description: A link to an ASPSP site where SCA is performed within the Redirect SCA approach.
        scaOAuth:
          $ref: '#/components/schemas/HrefType'
          description: The link refers to a JSON document specifying the OAuth details of the ASPSP’s authorisation server. JSON document follows the definition given in https://tools.ietf.org/html/draft-ietf-oauth- discovery.
        updatePsuIdentification:
          $ref: '#/components/schemas/HrefType'
          description: 'The link to the payment initiation or account information resource, which needs to be updated by the psu identification if not delivered yet.'
        updateProprietaryData:
          $ref: '#/components/schemas/HrefType'
          description: The link to the payment initiation or account information resource, which needs to be updated by the proprietary data.
        updatePsuAuthentication:
          $ref: '#/components/schemas/HrefType'
          description: 'The link to the payment initiation or account information resource, which needs to be updated by a psu password and eventually the psu identification if not delivered yet.'
        selectAuthenticationMethod:
          $ref: '#/components/schemas/HrefType'
          description: 'This is a link to a resource, where the TPP can select the applicable second factor authentication methods for the PSU, if there were several available authentication methods.'
        authoriseTransaction:
          $ref: '#/components/schemas/HrefType'
          description: 'The link to the payment initiation or consent resource, where the “Transaction Authorization”Request“ is sent to. This is the link to the resource which will authorize the payment or the consent by checking the SCA authentication data within the Embedded SCA approach.'
        self:
          $ref: '#/components/schemas/HrefType'
          description: The link to the payment initiation resource created by the request itself. This link can be used later to retrieve the transaction status of the payment initiation.
        status:
          type: string
          description: Status of the resource.
        account:
          $ref: '#/components/schemas/HrefType'
          description: A link to the resource providing the details of one account
        balances:
          $ref: '#/components/schemas/HrefType'
          description: A link to the resource providing the balance of a dedicated account.
        transactions:
          $ref: '#/components/schemas/HrefType'
          description: A link to the resource providing the transaction history of a dediated amount.
        transactionsDetails:
          $ref: '#/components/schemas/HrefType'
          description: A link to the resource providing details of a dedicated transaction.
        first:
          $ref: '#/components/schemas/HrefType'
          description: Navigation link for paginated account reports.
        next:
          $ref: '#/components/schemas/HrefType'
          description: Navigation link for paginated account reports.
        previous:
          $ref: '#/components/schemas/HrefType'
          description: Navigation link for paginated account reports.
        last:
          $ref: '#/components/schemas/HrefType'
          description: Navigation link for paginated account reports.
        download:
          $ref: '#/components/schemas/HrefType'
          description: Download link for huge AIS data packages.
    Authentication:
      type: object
      properties:
        authenticationType:
          type: string
          enum:
            - SMS_OTP
            - CHIP_OTP
            - PHOTO_OTP
            - PUSH_OTP
        authenticationVersion:
          type: string
          description: Depending on the "authenticationType". This version can be used by differentiating authentication tools used within performing OTP generation in the same authentication type. This version can be referred to in the ASPSP’s documentation.
        authenticationMethodId:
          type: string
          maxLength: 35
          description: An identification provided by the ASPSP for the later identification of the authentication method selection.
        name:
          type: string
          description: 'This is the name of the authentication method defined by the PSU in the Online Banking frontend of the ASPSP. Alternatively this could be a description provided by the ASPSP like “SMS OTP on phone +49160 xxxxx 28”. This name shall be used by the TPP when presenting a list of authentication methods to the PSU, if available.'
        explanation:
          type: string
          description: detailed information about the sca method for the PSU.
    Challenge:
      type: object
      properties:
        image:
          type: string
          description: 'PNG data (max. 512 kilobyte) to be displayed to the PSU, Base64 encoding. This attribute is used only, when PHOTO_OTP or CHIP_OTP is the selected SCA method.'
        data:
          type: string
          description: String challenge data
        imageLink:
          type: string
          description: A link where the ASPSP will provides the challenge image for the TPP.
        otpMaxLength:
          type: integer
          description: The maximal length for the OTP to be typed in by the PSU.
        otpFormat:
          type: string
          description: The format type of the OTP to be typed in. The admitted values are “characters” or “integer”.
          enum:
            - characters
            - integer
        additionalInformation:
          type: string
          description: Additional explanation for the PSU to explain e.g. fallback mechanism for the chosen sca method
    TppMessage:
      type: object
      required:
        - category
        - code
        - text
      properties:
        category:
          type: string
        code:
          type: string
        text:
          type: string 
    recurringIndicator:
      type: boolean
      description: '"true" if the consent is for recurring access to the account data "false", if the consent is for one access to the account data'
    consentsRequest:
      type: object
      required:
        - access
        - recurringIndicator
        - validUntil
        - frequencyPerDay
        - combinedServiceIndicator
      properties:
        access:
          $ref: '#/components/schemas/AccountAccess'
        recurringIndicator:
          $ref: '#/components/schemas/recurringIndicator'
        validUntil:
          type: string
          format: date
          description: 'This parameter is requesting a valid until date for the requested consent. The content is the local ASPSP date in ISODate Format, e.g. 2017-10-30. If a maximal available date is requested, a date in far future is to be used: "9999-12-31". The consent object to be retrieved by the GET Consent Request will contain the adjusted date.'
        frequencyPerDay:
          type: integer
          description: 'This field indicates the requested maximum frequency for an access per day. For a one-off access, this attribute is set to "1".'
        combinedServiceIndicator:
          type: boolean
          description: 'If "true" indicates that a payment initiation service will be addressed in the same "session", cp. Section 8.'
  # Reusable path, query, header and cookie parameters
  parameters:
    Content-Type:
      name: Content-Type
      in: header
      description: 'application/json'
      required: true
      schema:
        type: string
    account-id:
      name: account-id
      in: path
      description: 'This identification is denoting the addressed account. The account-id is retrieved by using a "Read Account List" call. The account-id is the "resourceId" attribute of the account structure. Its value is constant at least throughout the lifecycle of a given consent.'
      required: true
      schema:
        type: string
    transaction-id:
      name: transaction-id
      in: path
      description: Transaction ID
      required: true
      schema:
        type: integer
    resourceId:
      name: resourceId
      in: path
      description: This identification is given by the attribute resourceId of the corresponding entry of a transaction list.
      required: true
      schema:
        type: integer
    consentId:
      name: consentId
      in: path
      description: ID of the corresponding consent object as returned by an Account Information Consent Request
      required: true
      schema:
        type: string
    payment-product:
      name: payment-product
      in: path
      description: 'The addressed payment product, e.g. SCT. The default list of products supported in this standard is, pain.001-sepa-credit-transfers, pain.001-instant-sepa-credit-transfers, pain.001-target-2-payments or pain.001-cross-border-credit-transfers. Further products might be published by the ASPSP within its XS2A documentation.'
      required: true
      schema:
        type: string
        enum:
          - sepa-credit-transfers
          - instant-sepa-credit-transfers
          - target-2-payments
          - cross-border-credit-transfers
    payment-service:
      name: payment-service
      in: path
      description: 'The payment service to use.'
      required: true
      schema:
        type: string
        enum:
          - payments
          - bulk-payments
          - periodic-payments
    paymentId:
      name: paymentId
      in: path
      description: payment Id
      required: true
      schema:
       type: string
    withBalance:
      name: withBalance
      in: query
      description: 'If contained, this function reads the list of accessible payment accounts including the booking balance, if granted by the PSU in the related consent and available by the ASPSP. This parameter might be ignored by the ASPSP.'
      required: false
      schema:
        type: boolean
    X-Request-ID:
      name: X-Request-ID
      in: header
      description: 'ID of the request, unique to the call, as determined by the initiating party.'
      required: true
      schema:
        type: string
        format: uuid
    Consent-ID:
      name: Consent-ID
      in: header
      description: 'Shall be contained since "Establish Consent Transaction" was performed via this API before.'
      required: true
      schema:
        type: string
    Authorization:
      name: Authorization
      in: header
      description: 'Is contained only, if an OAuth2 based authentication was performed in a pre-step or an OAuth2 based SCA was performed in the related consent authorisation.'
      required: false
      schema:
        type: string
    Digest:
      name: Digest
      in: header
      description: 'Is contained if and only if the "Signature" element is contained in the header of the request.'
      required: false
      schema:
        type: string
    Signature:
      name: Signature
      in: header
      description: 'A signature of the request by the TPP on application level. This might be mandated by ASPSP.'
      required: false
      schema:
        type: string
    TPP-Signature-Certificate:
      name: TPP-Signature-Certificate
      in: header
      description: 'The certificate used for signing the request, in base64 encoding. It shall be contained if a signature is used, see above.'
      required: false
      schema:
        type: string
    dateFrom:
      name: dateFrom
      in: query
      description: 'Starting date (inclusive the date dateFrom) of the transaction list, mandated if no delta access is required'
      required: false
      schema:
        type: string
        format: date
    dateTo:
      name: dateTo
      in: query
      description: 'End date (inclusive the data dateTo) of the transaction list, default is now if not given.'
      required: false
      schema:
        type: string
        format: date
    entryReferenceFrom:
      name: entryReferenceFrom
      in: query
      description: 'This data attribute is indicating that the AISP is in favour to get all transactions after the transaction with identification entryReferenceFrom alternatively to the above defined period. This is a implementation of a delta access. If this data element is contained, the entries "dateFrom" and "dateTo" might be ignored by the ASPSP if a delta report is supported.'
      required: false
      schema:
        type: string
    bookingStatus:
      name: bookingStatus
      in: query
      description: 'Permitted codes are "booked", "pending" and "both "booked" shall be supported by the ASPSP. To support the "pending" and "both" feature is optional for the ASPSP, Error code if not supported in the online banking frontend'
      required: true
      schema:
        type: string
    PSU-ID:
      name: PSU-ID
      in: header
      description: Might be mandated in the ASPSP's documentation, if OAuth is not chosen as Pre-Step.
      required: false
      schema:
        type: string
    PSU-ID-Type:
      name: PSU-ID-Type
      in: header
      description: Type of the PSU-ID, needed in scenarios where PSUs have several PSU-IDs as access possibility.
      required: false
      schema:
        type: string
    PSU-Corporate-ID:
      name: PSU-Corporate-ID
      in: header
      description: Might be mandated in the ASPSP's documentation. Only used in a corporate context.
      required: false
      schema:
        type: string
    PSU-Corporate-ID-Type:
      name: PSU-Corporate-ID-Type
      in: header
      description: Might be mandated in the ASPSPs documentation. Only used in a corporate context.
      required: false
      schema:
        type: string
    PSU-IP-Address:
      name: PSU-IP-Address
      in: header
      description: The forwarded IP Address header field consists of the corresponding HTTP request IP Address field between PSU and TPP.
      required: true
      schema:
        type: string
    deltaList:
      name: deltaList
      in: query
      description: 'This data attribute is indicating that the AISP is in favour to get all transactions after the last report access for this PSU on the addressed account. This is another implementation of a delta access-report. This delta indicator might be rejected by the ASPSP if this function is not supported.'
      required: false
      schema:
        type: boolean
    TPP-Redirect-Preferred:
      name: TPP-Redirect-Preferred
      in: header
      description: 'If it equals "true", the TPP prefers a redirect over an embedded SCA approach. If it equals "false", the TPP prefers not to be redirected for SCA. The ASPSP will then choose between the Embedded or the Decoupled SCA approach, depending on the choice of the SCA procedure by the TPP/PSU. If the parameter is not used, the ASPSP will choose the SCA approach to be applied depending on the SCA method chosen by the TPP/PSU.'
      required: false
      schema:
        type: boolean
    TPP-Redirect-URI:
      name: TPP-Redirect-URI
      in: header
      description: 'URI of the TPP, where the transaction flow shall be redirected to after a Redirect. Mandatory for the SCA OAuth Approach.'
      required: false
      schema:
        type: string
    TPP-Nok-Redirect-URI:
      name: TPP-Nok-Redirect-URI
      in: header
      required: false
      schema:
        type: string
    Accept: 
      name: Accept
      in: header
      description: 'The TPP can indicate the formats of account reports supported together with a priorisation following the HTTP header definition.'
      required: false
      schema:
        type: string
        enum:
          - xml
          - JSON
          - text
  # Security scheme definition (see Authentication)
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-openpsd-key
  # Reusable request bodies
  # requestBodies:
  # Reusable responses, such as 401 Unauthorized or 400 Bad Request
  responses:
    '400BadRequest':
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TppMessage'
          example:
            category: Error
            code: '400'
            text: Validation error occured.
    '401Unauthorized':
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TppMessage'
          example:
            category: Error
            code: '401'
            text: Unauthorized
    '403Forbidden':
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TppMessage'
          example:
            category: Error
            code: '403'
            text: TPP role as defined in the certificate is not matching a payment initiation.
    '500InternalServerError':
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TppMessage'
          example:
            category: Error
            code: '500'
            text: Internal Server Error
          
  # Reusable response headers
  headers:
    Content-Type:
      required: true
      schema:
        type: string
        enum:
          - application/json
          - application/xml
          - application/text
      description: 'Possible values are application/json, application/xml or application/text'
    Location:
      required: true
      schema:
        type: string
      description: 'Location of the created resource.'
    X-Request-ID:
      required: true
      schema:
        type: string
        format: UUID
      description: 'ID of the request, unique to the call, as determined by the initiating party.'
    ASPSP-SCA-Approach:
      required: false
      schema:
        type: string
        enum:
          - EMBEDDED
          - DECOUPLED
          - REDIRECT
      description: 'Possible values are: EMBEDDED / DECOUPLED / REDIRECT. OAuth will be subsumed by the value REDIRECT'
  # Reusable examples
  #examples:
  # Reusable links
  #links:
  # Reusable callbacks
  #callbacks:
paths:
  '/accounts':
    get:
      tags:
        - account
      summary: list of accounts
      description: 'Reads a list of bank accounts, with balances where required. It is assumed that a consent of the PSU to this access is already given and stored on the ASPSP system. The addressed list of accounts depends then on the PSU ID and the stored consent addressed by consentId, respectively the OAuth2 access token.'
      operationId: getAccounts
      parameters:
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/withBalance"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                properties:
                  accounts:
                    type: array
                    items:
                      $ref: '#/components/schemas/AccountDetails'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/accounts/{account-id}':
    get:
      tags:
        - account
      summary: Account resource
      description: 'Reads a list of bank accounts, with balances where required. It is assumed that a consent of the PSU to this access is already given and stored on the ASPSP system. The addressed list of accounts depends then on the PSU ID and the stored consent addressed by consentId, respectively the OAuth2 access token.'
      operationId: queryAccounts
      parameters:
        - $ref: "#/components/parameters/account-id"
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/withBalance"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountDetails'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/accounts/{account-id}/balances':
    get:
      tags:
        - account
      summary: Account resource
      description: Reads the balance list for a given account.
      operationId: getBalanceForAccountByAccountId
      parameters:
        - $ref: "#/components/parameters/account-id"
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                properties:
                  account:
                    $ref: '#/components/schemas/AccountReference'
                  balances:
                    type: array
                    items:
                      $ref: '#/components/schemas/Balance'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/accounts/{account-id}/transactions':
    get:
      tags:
        - account
      summary: Account resource
      description: 'Reads a transaction list For a given account, additional parameters are e.g. the attributes “date_from” and “date_to”. If the attribute “withbalance” is used, the ASPSP will add balances to the transaction list. The latter might be provided by the ASPSP anyhow, if transaction lists without balances are not supported.'
      operationId: getTransactionsForAccountByAccountId
      parameters:
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
        - $ref: '#/components/parameters/account-id'
        - $ref: '#/components/parameters/dateFrom'
        - $ref: '#/components/parameters/dateTo'
        - $ref: '#/components/parameters/entryReferenceFrom'
        - $ref: '#/components/parameters/bookingStatus'
        - $ref: '#/components/parameters/deltaList'
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          headers:
            Content-Type:
              $ref: '#/components/headers/Content-Type'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                properties:
                  account:
                    $ref: '#/components/schemas/AccountReference'
                  transactions:
                    $ref: '#/components/schemas/AccountReport'
                  _links:
                    $ref: '#/components/schemas/Links'
                  balances:
                    type: array
                    items:
                      $ref: '#/components/schemas/Balance'
            application/xml:
              schema:
                type: object
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/accounts/{account-id}/transactions/{resourceId}':
    get:
      tags:
        - account
      summary: Account resource
      description: Reads transaction details of an addressed transaction.
      operationId: getTransactionByTransactionIdForAccountByAccountId
      parameters:
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
        - $ref: '#/components/parameters/resourceId'
        - $ref: '#/components/parameters/account-id'
      responses:
        '200':
          description: OK
          headers:
            Content-Type:
              $ref: '#/components/headers/Content-Type'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                properties:
                  transactionsDetails:
                    $ref: '#/components/schemas/Transaction'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/consents':
    post:
      tags:
        - Consent
      summary: Consent resource
      description: 'Creates a consent resource, defining access rights to dedicated accounts of a given PSU-ID. These accounts must be addressed explicitly in the method as parameters.'
      operationId: postConsent
      parameters:
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/PSU-ID"
        - $ref: "#/components/parameters/PSU-ID-Type"
        - $ref: "#/components/parameters/PSU-Corporate-ID"
        - $ref: "#/components/parameters/PSU-Corporate-ID-Type"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/TPP-Redirect-Preferred"
        - $ref: "#/components/parameters/TPP-Redirect-URI"
        - $ref: "#/components/parameters/TPP-Nok-Redirect-URI"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/consentsRequest'
      responses:
        '201':
          description: Consent Request was correctly performed.
          headers:
            Location:
              $ref: '#/components/headers/Location'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            ASPSP-SCA-Approach:
              $ref: '#/components/headers/ASPSP-SCA-Approach'
          content:
            application/json:
              schema:
                type: object
                required:
                  - consentStatus
                  - _links
                properties:
                  consentStatus:
                    $ref: '#/components/schemas/ConsentStatus'
                  consentId:
                    $ref: '#/components/schemas/consentId'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  chosenSca Method:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  _links:
                    $ref: '#/components/schemas/Links'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/consents/{consentId}':
    get:
      tags:
        - Consent
      summary: Consent resource
      description: 'Reads the exact definition of the given consent resource {consentId}'
      parameters:
        - $ref: '#/components/parameters/consentId'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                required:
                  - access
                  - recurringIndicator
                  - validUntil
                  - frequencyPerDay
                  - lastActionDate
                  - consentStatus
                properties:
                  access:
                    $ref: "#/components/schemas/AccountAccess"
                  recurringIndicator:
                    $ref: "#/components/schemas/recurringIndicator"
                  validUntil:
                    type: string
                    format: date
                  frequencyPerDay:
                    type: integer
                  lastActionDate:
                    type: string
                    format: date
                  consentStatus:
                    $ref: "#/components/schemas/ConsentStatus"
                  scaStatus:
                    $ref: "#/components/schemas/scaStatus"
                  
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
    put:
      tags:
        - Consent
      summary: Consent resource
      description: 'Updates data on the consent resource, authorises a consent within the Embedded SCA Approach where needed.'
      parameters:
        - $ref: "#/components/parameters/consentId"
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/PSU-ID"
        - $ref: "#/components/parameters/PSU-ID-Type"
        - $ref: "#/components/parameters/PSU-Corporate-ID"
        - $ref: "#/components/parameters/PSU-Corporate-ID-Type"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                psuData:
                  $ref: '#/components/schemas/PSUData'
                authenticationMethodId:
                  type: string
                scaAuthenticationData:
                  type: string
      responses:
        '201':
          description: OK
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            ASPSP-SCA-Approach:
              $ref: '#/components/headers/ASPSP-SCA-Approach'
          content:
            application/json:
              schema:
                type: object
                properties:
                  chosenScaMethod:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  _links:
                    $ref: '#/components/schemas/Links'
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  consentStatus:
                    $ref: '#/components/schemas/ConsentStatus'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
    delete:
      tags:
        - Consent
      summary: Consent resource
      description: Deletes a created consent with ID.
      operationId: deleteConsentWithID
      parameters:
        - $ref: "#/components/parameters/consentId"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/X-Request-ID"
      security:
        - APIKeyQueryParam: []
      responses:
        '204':
          description: Consent resource was successfully deleted.
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/consents/{consentId}/status':
    get:
      tags:
        - Consent
      summary: Consent resource
      description: Reads the transaction status of the addressed consent resource.
      parameters:
        - $ref: '#/components/parameters/consentId'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: 'Transaction status'
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                required:
                  - consentStatus
                properties:
                  consentStatus:
                    $ref: '#/components/schemas/ConsentStatus'
                  scaStatus:
                    $ref: '#/components/schemas/scaStatus'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/{payment-service}/{payment-product}':
    post:
      tags:
        - payments
      summary: Payment resource
      description: 'Creates a payment initiation resource addressable under {paymentId} with all data relevant for the corresponding payment product. This is the first step in the API to initiate the related payment'
      operationId: postPaymentsWithPaymentProduct
      parameters:
        - $ref: '#/components/parameters/payment-service'
        - $ref: '#/components/parameters/payment-product'
        - $ref: '#/components/parameters/Content-Type'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/PSU-ID"
        - $ref: "#/components/parameters/PSU-ID-Type"
        - $ref: "#/components/parameters/PSU-Corporate-ID"
        - $ref: "#/components/parameters/PSU-Corporate-ID-Type"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/PSU-IP-Address"
        - $ref: "#/components/parameters/TPP-Redirect-Preferred"
        - $ref: "#/components/parameters/TPP-Redirect-URI"
        - $ref: "#/components/parameters/TPP-Nok-Redirect-URI"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                required:
                  - transactionStatus
                  - paymentId
                  - _links
                properties:
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  paymentId:
                    $ref: '#/components/schemas/paymentId'
                  transactionFees:
                    $ref: '#/components/schemas/Amount'
                  transactionFeeIndicator:
                    $ref: '#/components/schemas/transactionFeeIndicator'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  chosenScaMethod:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  _links:
                    $ref: '#/components/schemas/Links'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
                  tppMessages:
                    type: array
                    items:
                      $ref: '#/components/schemas/TppMessage'
            application/xml:
              schema:
                type: object
                required:
                  - transactionStatus
                  - paymentId
                  - _links
                properties:
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  paymentId:
                    $ref: '#/components/schemas/paymentId'
                  transactionFees:
                    $ref: '#/components/schemas/Amount'
                  transactionFeeIndicator:
                    type: boolean
                    description: 'If equals “true”, the transaction will involve specific transaction cost as shown by the ASPSP in their public price list or as agreed between ASPSP and PSU. If equals “false”, the transaction will not involve additional specific transaction costs to the PSU.'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  chosenScaMethod:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  _links:
                    $ref: '#/components/schemas/Links'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
                  tppMessages:
                    type: array
                    items:
                      $ref: '#/components/schemas/TppMessage'
          headers:
            Location:
              $ref: '#/components/headers/Location'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            ASPSP-SCA-Approach:
              $ref: '#/components/headers/ASPSP-SCA-Approach'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/payments/{payment-product}/{paymentId}':
    put:
      tags:
        - payments
      summary: Payment resource
      description: Updates data on the payment resource if needed. It may authorise a payment within the Embedded SCA Approach where needed.
      parameters:
        - $ref: '#/components/parameters/payment-product'
        - $ref: '#/components/parameters/paymentId'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/PSU-ID"
        - $ref: "#/components/parameters/PSU-ID-Type"
        - $ref: "#/components/parameters/PSU-Corporate-ID"
        - $ref: "#/components/parameters/PSU-Corporate-ID-Type"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                psuData:
                  $ref: '#/components/schemas/PSUData'
                authenticationMethodId:
                  type: string
                scaAuthenticationData:
                  type: string
      responses:
        '201':
          description: OK result with Decoupled Approach
          content:
            application/json:
              schema:
                type: object
                required:
                  - transactionStatus
                properties:
                  chosenScaMethod:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  _links:
                    $ref: '#/components/schemas/Links'
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  consentStatus:
                    $ref: '#/components/schemas/ConsentStatus'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            ASPSP-SCA-Approach:
              $ref: '#/components/headers/ASPSP-SCA-Approach'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
    get:
      tags:
        - payments
      summary: Payment resource
      description: Reads the details of an initiated payment.
      parameters:
        - $ref: '#/components/parameters/payment-product'
        - $ref: '#/components/parameters/paymentId'
        - $ref: '#/components/parameters/Content-Type'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/PSU-ID"
        - $ref: "#/components/parameters/PSU-ID-Type"
        - $ref: "#/components/parameters/PSU-Corporate-ID"
        - $ref: "#/components/parameters/PSU-Corporate-ID-Type"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/PSU-IP-Address"
        - $ref: "#/components/parameters/TPP-Redirect-Preferred"
        - $ref: "#/components/parameters/TPP-Redirect-URI"
        - $ref: "#/components/parameters/TPP-Nok-Redirect-URI"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
            application/xml:
              schema:
                type: object
          headers:
            Location:
              $ref: '#/components/headers/Location'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            ASPSP-SCA-Approach:
              $ref: '#/components/headers/ASPSP-SCA-Approach'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/payments/{payment-product}/{paymentId}/status':
    get:
      tags:
        - payments
      summary: Payment resource
      description: Reads the transaction status of the payment
      parameters:
        - $ref: '#/components/parameters/payment-product'
        - $ref: '#/components/parameters/paymentId'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      responses:
        '200':
          description: OK
          headers:
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                properties:
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  scaStatus:
                    $ref: '#/components/schemas/scaStatus'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/bulk-payments/{payment-product}':
    post:
      tags:
        - payments
      summary: Payment resource
      description: 'Creates a payment initiation resource addressable under {paymentId} with all data relevant for the corresponding payment product. This is the first step in the API to initiate the related payment'
      operationId: Creates a bulk payment initiation request at the ASPSP
      parameters:
        - $ref: '#/components/parameters/payment-product'
        - $ref: '#/components/parameters/Content-Type'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/PSU-ID"
        - $ref: "#/components/parameters/PSU-ID-Type"
        - $ref: "#/components/parameters/PSU-Corporate-ID"
        - $ref: "#/components/parameters/PSU-Corporate-ID-Type"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/PSU-IP-Address"
        - $ref: "#/components/parameters/TPP-Redirect-Preferred"
        - $ref: "#/components/parameters/TPP-Redirect-URI"
        - $ref: "#/components/parameters/TPP-Nok-Redirect-URI"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK
          headers:
            Location:
              $ref: '#/components/headers/Location'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            ASPSP-SCA-Approach:
              $ref: '#/components/headers/ASPSP-SCA-Approach'
          content:
            application/json:
              schema:
                type: object
                required:
                  - transactionStatus
                  - paymentId
                  - _links
                properties:
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  paymentId:
                    $ref: '#/components/schemas/paymentId'
                  transactionFees:
                    $ref: '#/components/schemas/Amount'
                  transactionFeeIndicator:
                    $ref: '#/components/schemas/transactionFeeIndicator'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  chosenScaMethod:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  _links:
                    $ref: '#/components/schemas/Links'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
                  tppMessages:
                    type: array
                    items:
                      $ref: '#/components/schemas/TppMessage'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/periodic-payments/{payment-product}':
    post:
      tags:
        - payments
      summary: Payment resource
      description: 'Creates a payment initiation resource addressable under {paymentID} with all data relevant for the corresponding payment product. This is the first step in the API to initiate the related payment'
      operationId: Creates a periodic payment initiation request at the ASPSP
      parameters:
        - $ref: '#/components/parameters/payment-product'
        - $ref: '#/components/parameters/Content-Type'
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/PSU-ID"
        - $ref: "#/components/parameters/PSU-ID-Type"
        - $ref: "#/components/parameters/PSU-Corporate-ID"
        - $ref: "#/components/parameters/PSU-Corporate-ID-Type"
        - $ref: "#/components/parameters/Authorization"
        - $ref: "#/components/parameters/Consent-ID"
        - $ref: "#/components/parameters/PSU-IP-Address"
        - $ref: "#/components/parameters/TPP-Redirect-Preferred"
        - $ref: "#/components/parameters/TPP-Redirect-URI"
        - $ref: "#/components/parameters/TPP-Nok-Redirect-URI"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      security:
        - APIKeyQueryParam: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                startDate:
                  type: string
                  format: date
                executionRule:
                  type: string
                endDate:
                  type: string
                  format: date
                frequency:
                  $ref: "#/components/schemas/frequency"
                dayOfExecution:
                  type: integer
                  minimum: 1
                  maximum: 31
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                required:
                  - transactionStatus
                  - paymentId
                  - _links
                properties:
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  paymentId:
                    $ref: '#/components/schemas/paymentId'
                  transactionFees:
                    $ref: '#/components/schemas/Amount'
                  transactionFeeIndicator:
                    $ref: '#/components/schemas/transactionFeeIndicator'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  chosenScaMethod:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  _links:
                    $ref: '#/components/schemas/Links'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
                  tppMessages:
                    type: array
                    items:
                      $ref: '#/components/schemas/TppMessage'
            application/xml:
              schema:
                type: object
                required:
                  - transactionStatus
                  - paymentId
                  - _links
                properties:
                  transactionStatus:
                    $ref: '#/components/schemas/TransactionStatus'
                  paymentId:
                    $ref: '#/components/schemas/paymentId'
                  transactionFees:
                    $ref: '#/components/schemas/Amount'
                  transactionFeeIndicator:
                    type: boolean
                    description: 'If equals “true”, the transaction will involve specific transaction cost as shown by the ASPSP in their public price list or as agreed between ASPSP and PSU. If equals “false”, the transaction will not involve additional specific transaction costs to the PSU.'
                  scaMethods:
                    type: array
                    items:
                      $ref: '#/components/schemas/Authentication'
                  chosenScaMethod:
                    $ref: '#/components/schemas/Authentication'
                  challengeData:
                    $ref: '#/components/schemas/Challenge'
                  _links:
                    $ref: '#/components/schemas/Links'
                  psuMessage:
                    $ref: '#/components/schemas/psuMessage'
                  tppMessages:
                    type: array
                    items:
                      $ref: '#/components/schemas/TppMessage'
          headers:
            Location:
              $ref: '#/components/headers/Location'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
            ASPSP-SCA-Approach:
              $ref: '#/components/headers/ASPSP-SCA-Approach'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'
  '/funds-confirmations':
    post:
      tags:
        - Funds
      summary: Funds resource
      description: 'Checks whether funds are available for a payment transaction on an account linked with a given tuple cardissuer/cardnumber, or an IBAN and TPP respectively'
      security:
        - APIKeyQueryParam: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                cardNumber:
                  type: string
                account:
                  $ref: "#/components/schemas/AccountReference"
                payee:
                  type: string
                  maxLength: 70
                instructedAmount:
                  $ref: "#/components/schemas/Amount"
      parameters:
        - $ref: "#/components/parameters/X-Request-ID"
        - $ref: "#/components/parameters/Digest"
        - $ref: "#/components/parameters/Signature"
        - $ref: "#/components/parameters/TPP-Signature-Certificate"
      responses:
        '200':
          description: OK
          headers:
            Location:
              $ref: '#/components/headers/Location'
            X-Request-ID:
              $ref: '#/components/headers/X-Request-ID'
          content:
            application/json:
              schema:
                type: object
                required:
                  - fundsAvaiable
                properties:
                  fundsAvaiable:
                    type: boolean
                    description: 'Equals “true” if sufficient funds are available at the time of the request, “false” otherwise.'
        '400':
          $ref: '#/components/responses/400BadRequest'
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '500':
          $ref: '#/components/responses/500InternalServerError'